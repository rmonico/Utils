<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project>

<project name="Utils" default="deploy" basedir=".">
	<description>
		Utils Build and Deploy File
    </description>

	<!-- set global properties for this build -->
	<property name="src" location="src" />
	<property name="lib" location="lib" />
	<property name="build" location="build" />
	<property name="deployFolder" location="../library/utils" />
	<loadproperties srcFile="version" />


	<target name="init">
		<tstamp />
	</target>

	<target name="compile" depends="init" description="compile the source ">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}" destdir="${build}"
			classpath="${lib}/eclipselink/eclipselink-2.2.0.jar:${lib}/eclipselink/eclipselink-javax.persistence-2.0.jar:${lib}/eclipselink/eclipselink-jpa-modelgen-2.2.0.jar:${lib}/junit/junit-4.8.2.jar" />
	</target>

	<target name="deploy" depends="compile" description="generate the distribution">
		<!-- Updates the build number -->
		<propertyfile file="version">
			<entry key="version.build" type="int" operation="+" value="1" />
		</propertyfile>

		<jar
			jarfile="${deployFolder}/Utils-${version.major}.${version.minor}.${version.build}.jar"
			basedir="${build}" />

		<antcall target="showCurrentVersion" />
	</target>

	<target name="increment_minor_version">
		<propertyfile file="version">
			<entry key="version.minor" type="int" operation="+" value="1" />
		</propertyfile>

		<antcall target="showCurrentVersion" />
	</target>

	<target name="increment_major_version">
		<propertyfile file="version">
			<entry key="version.major" type="int" operation="+" value="1" />
		</propertyfile>

		<antcall target="showCurrentVersion" />
	</target>

	<target name="showCurrentVersion">
		<echo
			message="current version = ${version.major}.${version.minor}.${version.build}" />
	</target>

	<target name="UpdateProductionVersion">
		<copy file="${workspaceLibrary}/utils/Utils-${version.major}.${version.minor}.${version.build}.jar" toFile="${workspaceLibrary}/utils/Utils.jar" />
	</target>

</project>